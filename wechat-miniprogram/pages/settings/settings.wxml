<!--pages/settings/settings.wxml-->
<view class="container">
  <scroll-view class="settings-scroll" scroll-y="true">
    
    <!-- 连接设置 -->
    <view class="settings-section">
      <view class="section-title">连接设置</view>
      
      <view class="setting-item">
        <view class="setting-label">自动连接</view>
        <switch checked="{{connectionSettings.autoConnect}}" 
               bindchange="onAutoConnectChange" />
      </view>
      
      <view class="setting-item">
        <view class="setting-label">保持连接</view>
        <switch checked="{{connectionSettings.keepAlive}}" 
               bindchange="onKeepAliveChange" />
      </view>
      
      <view class="setting-item">
        <view class="setting-label">重连间隔 (秒)</view>
        <picker mode="selector" range="{{[3, 5, 10, 15, 30]}}" 
               value="{{connectionSettings.reconnectInterval / 1000 === 3 ? 0 : connectionSettings.reconnectInterval / 1000 === 5 ? 1 : connectionSettings.reconnectInterval / 1000 === 10 ? 2 : connectionSettings.reconnectInterval / 1000 === 15 ? 3 : 4}}"
               bindchange="onReconnectIntervalChange">
          <view class="picker-text">{{connectionSettings.reconnectInterval / 1000}}秒</view>
        </picker>
      </view>
      
      <view class="setting-item">
        <view class="setting-label">最大重连次数</view>
        <picker mode="selector" range="{{[1, 3, 5, 10]}}" 
               value="{{connectionSettings.maxReconnectAttempts === 1 ? 0 : connectionSettings.maxReconnectAttempts === 3 ? 1 : connectionSettings.maxReconnectAttempts === 5 ? 2 : 3}}"
               bindchange="onMaxReconnectAttemptsChange">
          <view class="picker-text">{{connectionSettings.maxReconnectAttempts}}次</view>
        </picker>
      </view>
    </view>

    <!-- 视频设置 -->
    <view class="settings-section">
      <view class="section-title">视频设置</view>
      
      <view class="setting-item">
        <view class="setting-label">视频质量</view>
        <picker mode="selector" range="{{['低', '中', '高']}}" 
               value="{{videoSettings.quality === 'low' ? 0 : videoSettings.quality === 'medium' ? 1 : 2}}"
               bindchange="onVideoQualityChange">
          <view class="picker-text">{{getQualityText(videoSettings.quality)}}</view>
        </picker>
      </view>
      
      <view class="setting-item">
        <view class="setting-label">帧率</view>
        <picker mode="selector" range="{{['15fps', '24fps', '30fps', '60fps']}}" 
               value="{{videoSettings.frameRate === 15 ? 0 : videoSettings.frameRate === 24 ? 1 : videoSettings.frameRate === 30 ? 2 : 3}}"
               bindchange="onFrameRateChange">
          <view class="picker-text">{{videoSettings.frameRate}}fps</view>
        </picker>
      </view>
      
      <view class="setting-item">
        <view class="setting-label">硬件加速</view>
        <switch checked="{{videoSettings.enableHardwareAcceleration}}" 
               bindchange="onHardwareAccelerationChange" />
      </view>
      
      <view class="setting-item">
        <view class="setting-label">自适应码率</view>
        <switch checked="{{videoSettings.adaptiveBitrate}}" 
               bindchange="onAdaptiveBitrateChange" />
      </view>
    </view>

    <!-- 音频设置 -->
    <view class="settings-section">
      <view class="section-title">音频设置</view>
      
      <view class="setting-item">
        <view class="setting-label">启用音频</view>
        <switch checked="{{audioSettings.enabled}}" 
               bindchange="onAudioEnabledChange" />
      </view>
      
      <view class="setting-item">
        <view class="setting-label">音频质量</view>
        <picker mode="selector" range="{{['低', '中', '高']}}" 
               value="{{audioSettings.quality === 'low' ? 0 : audioSettings.quality === 'medium' ? 1 : 2}}"
               bindchange="onAudioQualityChange">
          <view class="picker-text">{{getQualityText(audioSettings.quality)}}</view>
        </picker>
      </view>
      
      <view class="setting-item">
        <view class="setting-label">回声消除</view>
        <switch checked="{{audioSettings.echoCancellation}}" 
               bindchange="onEchoCancellationChange" />
      </view>
      
      <view class="setting-item">
        <view class="setting-label">噪声抑制</view>
        <switch checked="{{audioSettings.noiseSuppression}}" 
               bindchange="onNoiseSuppressionChange" />
      </view>
    </view>

    <!-- 文件传输设置 -->
    <view class="settings-section">
      <view class="section-title">文件传输设置</view>
      
      <view class="setting-item">
        <view class="setting-label">最大文件大小 (MB)</view>
        <picker mode="selector" range="{{[50, 100, 200, 500, 1000]}}" 
               value="{{fileSettings.maxFileSize === 50 ? 0 : fileSettings.maxFileSize === 100 ? 1 : fileSettings.maxFileSize === 200 ? 2 : fileSettings.maxFileSize === 500 ? 3 : 4}}"
               bindchange="onMaxFileSizeChange">
          <view class="picker-text">{{fileSettings.maxFileSize}}MB</view>
        </picker>
      </view>
      
      <view class="setting-item">
        <view class="setting-label">自动保存</view>
        <switch checked="{{fileSettings.autoSave}}" 
               bindchange="onAutoSaveChange" />
      </view>
      
      <view class="setting-item">
        <view class="setting-label">启用压缩</view>
        <switch checked="{{fileSettings.compressionEnabled}}" 
               bindchange="onCompressionChange" />
      </view>
    </view>

    <!-- 安全设置 -->
    <view class="settings-section">
      <view class="section-title">安全设置</view>
      
      <view class="setting-item">
        <view class="setting-label">需要身份验证</view>
        <switch checked="{{securitySettings.requireAuth}}" 
               bindchange="onRequireAuthChange" />
      </view>
      
      <view class="setting-item">
        <view class="setting-label">会话超时 (分钟)</view>
        <picker mode="selector" range="{{[15, 30, 60, 120]}}" 
               value="{{securitySettings.sessionTimeout === 15 ? 0 : securitySettings.sessionTimeout === 30 ? 1 : securitySettings.sessionTimeout === 60 ? 2 : 3}}"
               bindchange="onSessionTimeoutChange">
          <view class="picker-text">{{securitySettings.sessionTimeout}}分钟</view>
        </picker>
      </view>
      
      <view class="setting-item">
        <view class="setting-label">启用加密</view>
        <switch checked="{{securitySettings.encryptionEnabled}}" 
               bindchange="onEncryptionChange" />
      </view>
      
      <view class="setting-item">
        <view class="setting-label">允许截图</view>
        <switch checked="{{securitySettings.allowScreenshots}}" 
               bindchange="onAllowScreenshotsChange" />
      </view>
    </view>

    <!-- 界面设置 -->
    <view class="settings-section">
      <view class="section-title">界面设置</view>
      
      <view class="setting-item">
        <view class="setting-label">主题</view>
        <picker mode="selector" range="{{['浅色', '深色', '跟随系统']}}" 
               value="{{uiSettings.theme === 'light' ? 0 : uiSettings.theme === 'dark' ? 1 : 2}}"
               bindchange="onThemeChange">
          <view class="picker-text">{{getThemeText(uiSettings.theme)}}</view>
        </picker>
      </view>
      
      <view class="setting-item">
        <view class="setting-label">语言</view>
        <picker mode="selector" range="{{['简体中文', 'English']}}" 
               value="{{uiSettings.language === 'zh-CN' ? 0 : 1}}"
               bindchange="onLanguageChange">
          <view class="picker-text">{{uiSettings.language === 'zh-CN' ? '简体中文' : 'English'}}</view>
        </picker>
      </view>
      
      <view class="setting-item">
        <view class="setting-label">显示FPS</view>
        <switch checked="{{uiSettings.showFPS}}" 
               bindchange="onShowFPSChange" />
      </view>
      
      <view class="setting-item">
        <view class="setting-label">显示网络状态</view>
        <switch checked="{{uiSettings.showNetworkStatus}}" 
               bindchange="onShowNetworkStatusChange" />
      </view>
    </view>

    <!-- 存储信息 -->
    <view class="settings-section">
      <view class="section-title">存储信息</view>
      
      <view class="storage-info">
        <view class="storage-text">
          已使用: {{formatStorageSize(storageInfo.used)}} / {{formatStorageSize(storageInfo.total)}}
        </view>
        <view class="storage-bar">
          <view class="storage-fill" style="width: {{storageInfo.percentage}}%"></view>
        </view>
        <view class="storage-percentage">{{storageInfo.percentage}}%</view>
      </view>
      
      <view class="setting-item">
        <button class="clear-cache-btn" bindtap="clearCache">清理缓存</button>
      </view>
    </view>

    <!-- 系统信息 -->
    <view class="settings-section" wx:if="{{systemInfo}}">
      <view class="section-title">系统信息</view>
      
      <view class="info-item">
        <text class="info-label">设备型号:</text>
        <text class="info-value">{{systemInfo.model}}</text>
      </view>
      
      <view class="info-item">
        <text class="info-label">系统版本:</text>
        <text class="info-value">{{systemInfo.system}}</text>
      </view>
      
      <view class="info-item">
        <text class="info-label">微信版本:</text>
        <text class="info-value">{{systemInfo.version}}</text>
      </view>
      
      <view class="info-item">
        <text class="info-label">屏幕分辨率:</text>
        <text class="info-value">{{systemInfo.screenWidth}} × {{systemInfo.screenHeight}}</text>
      </view>
      
      <view class="info-item">
        <text class="info-label">设备ID:</text>
        <text class="info-value">{{deviceId}}</text>
      </view>
    </view>

    <!-- 其他操作 -->
    <view class="settings-section">
      <view class="section-title">其他</view>
      
      <view class="setting-item">
        <button class="action-btn" bindtap="checkUpdate">检查更新</button>
      </view>
      
      <view class="setting-item">
        <button class="action-btn" bindtap="resetSettings">重置设置</button>
      </view>
      
      <view class="setting-item">
        <button class="action-btn" bindtap="feedback">问题反馈</button>
      </view>
      
      <view class="setting-item">
        <button class="action-btn" bindtap="showAbout">关于应用</button>
      </view>
    </view>

  </scroll-view>
</view>